<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hierarchical relationship between partitions with different number of clusters — plot_clust_hierarchical • ClustAssess</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hierarchical relationship between partitions with different number of clusters — plot_clust_hierarchical"><meta name="description" content="After assessing the stability of the clustering step, the user
can visualise the relationship between the partitions as the number of
clusters changes. The aim is to understand the hierarchical relationship
between super and sub celltypes. The function will create a plot that will
represent the clusters of each partition as nodes. The colours of the nodes
will indicate the stability of the cluster. The size is proportional to the
number of cells in the cluster. The edges will represent the relationship
between the clusters of two partitions. The colour of the edges will indicate
the stability of the relationship between the clusters. The thickness of the
edges will indicate the number of cells that are shared between the two
clusters."><meta property="og:description" content="After assessing the stability of the clustering step, the user
can visualise the relationship between the partitions as the number of
clusters changes. The aim is to understand the hierarchical relationship
between super and sub celltypes. The function will create a plot that will
represent the clusters of each partition as nodes. The colours of the nodes
will indicate the stability of the cluster. The size is proportional to the
number of cells in the cluster. The edges will represent the relationship
between the clusters of two partitions. The colour of the edges will indicate
the stability of the relationship between the clusters. The thickness of the
edges will indicate the number of cells that are shared between the two
clusters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClustAssess</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ClustAssess.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/comparing-soft-and-hierarchical.html">Comparing soft and hierarchical clusterings with element-centric similarity</a></li>
    <li><a class="dropdown-item" href="../articles/stability-dim-reduction-flexibility.html">Flexibility of the dimensionality reduction assessment</a></li>
    <li><a class="dropdown-item" href="../articles/stability-pipeline-description.html">Stability-based parameter assessment</a></li>
    <li><a class="dropdown-item" href="../articles/stability-pipeline-shiny.html">Automatic ClustAssess pipeline. Generating the ClustAssess shiny-app</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../tutorials/index.html">ClustAssess Shiny app Tutorial</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Core-Bioinformatics/ClustAssess/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hierarchical relationship between partitions with different number of clusters</h1>
      <small class="dont-index">Source: <a href="https://github.com/Core-Bioinformatics/ClustAssess/blob/HEAD/R/stability-3-graph-clustering.R" class="external-link"><code>R/stability-3-graph-clustering.R</code></a></small>
      <div class="d-none name"><code>plot_clust_hierarchical.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>After assessing the stability of the clustering step, the user
can visualise the relationship between the partitions as the number of
clusters changes. The aim is to understand the hierarchical relationship
between super and sub celltypes. The function will create a plot that will
represent the clusters of each partition as nodes. The colours of the nodes
will indicate the stability of the cluster. The size is proportional to the
number of cells in the cluster. The edges will represent the relationship
between the clusters of two partitions. The colour of the edges will indicate
the stability of the relationship between the clusters. The thickness of the
edges will indicate the number of cells that are shared between the two
clusters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_clust_hierarchical</span><span class="op">(</span></span>
<span>  <span class="va">clustering_assessment</span>,</span>
<span>  clustering_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  edge_threshold <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  range_point_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  range_edge_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  edge_palette_name <span class="op">=</span> <span class="st">"RColorBrewer::Greys"</span>,</span>
<span>  edge_palette_inverse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  node_palette_name <span class="op">=</span> <span class="st">"viridis::rocket"</span>,</span>
<span>  node_palette_inverse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-clustering-assessment">clustering_assessment<a class="anchor" aria-label="anchor" href="#arg-clustering-assessment"></a></dt>
<dd><p>An object returned by the
<code>assess_clustering_stability</code> method.</p></dd>


<dt id="arg-clustering-method">clustering_method<a class="anchor" aria-label="anchor" href="#arg-clustering-method"></a></dt>
<dd><p>A string that specifies the clustering method.
Should be one of the following: 'Louvain', 'Louvain.refined', 'SLM', 'Leiden'.
If <code>NULL</code>, the first clustering method will be used. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>A vector of integers that specifies the number of clusters. If
<code>NULL</code>, all available values will be used. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-edge-threshold">edge_threshold<a class="anchor" aria-label="anchor" href="#arg-edge-threshold"></a></dt>
<dd><p>A numeric value that specifies the quantile threshold
for the edges. The edges with the intersection size below the quantile
threshold will be removed. Defaults to <code>0.3</code>.</p></dd>


<dt id="arg-range-point-size">range_point_size<a class="anchor" aria-label="anchor" href="#arg-range-point-size"></a></dt>
<dd><p>A numeric vector of length 2 that specifies the
minimum and the maximum size of the nodes. Defaults to <code>c(1, 6)</code>.</p></dd>


<dt id="arg-range-edge-width">range_edge_width<a class="anchor" aria-label="anchor" href="#arg-range-edge-width"></a></dt>
<dd><p>A numeric vector of length 2 that specifies the
minimum and the maximum width of the edges. Defaults to <code>c(0.01, 3)</code>.</p></dd>


<dt id="arg-edge-palette-name">edge_palette_name<a class="anchor" aria-label="anchor" href="#arg-edge-palette-name"></a></dt>
<dd><p>A string that specifies the name of the palette
that will be used for the edges. Defaults to <code>"RColorBrewer::Greys"</code>.</p></dd>


<dt id="arg-edge-palette-inverse">edge_palette_inverse<a class="anchor" aria-label="anchor" href="#arg-edge-palette-inverse"></a></dt>
<dd><p>A boolean value that specifies whether the
palette should be inverted. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-node-palette-name">node_palette_name<a class="anchor" aria-label="anchor" href="#arg-node-palette-name"></a></dt>
<dd><p>A string that specifies the name of the palette
that will be used for the nodes. Defaults to <code>"viridis::rocket"</code>.</p></dd>


<dt id="arg-node-palette-inverse">node_palette_inverse<a class="anchor" aria-label="anchor" href="#arg-node-palette-inverse"></a></dt>
<dd><p>A boolean value that specifies whether the
palette should be inverted. Defaults to <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object following the details from description.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The names of the colour palettes should follow the format defined in
the <code>paletteer</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># create an artificial PCA embedding</span></span></span>
<span class="r-in"><span><span class="va">pca_embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">30</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">pca_embedding</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pca_embedding</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pca_embedding</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adj_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="getNNmatrix.html">getNNmatrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">RANN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RANN/man/nn2.html" class="external-link">nn2</a></span><span class="op">(</span><span class="va">pca_embedding</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">nn.idx</span>,</span></span>
<span class="r-in"><span>    <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">$</span><span class="va">nn</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">adj_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">adj_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">adj_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">adj_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># alternatively, the adj_matrix can be calculated</span></span></span>
<span class="r-in"><span><span class="co"># using the `Seurat::FindNeighbors` function.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">clust_diff_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="assess_clustering_stability.html">assess_clustering_stability</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    graph_adjacency_matrix <span class="op">=</span> <span class="va">adj_matrix</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    n_repetitions <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    clustering_algorithm <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_clust_hierarchical</span><span class="op">(</span><span class="va">clust_diff_obj</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_clust_hierarchical-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andi Munteanu, Arash Shahsavari, Miguel Larraz Lopez de Novales, Irina Mohorianu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

